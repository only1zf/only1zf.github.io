"use strict";(self.webpackChunkpub=self.webpackChunkpub||[]).push([[5164],{3306:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>r,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"py-struct","title":"Structure of the Python Repository","description":"Sample Repository","source":"@site/docs/py-struct.md","sourceDirName":".","slug":"/py-struct","permalink":"/docs/py-struct","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Structure of the Python Repository","date":"2020-11-05T06:30:59Z"},"sidebar":"refSidebar","previous":{"title":"Python","permalink":"/docs/py-main"},"next":{"title":"\u8bfb\u8003","permalink":"/docs/read/"}}');var o=s(4848),l=s(8453);const a={title:"Structure of the Python Repository",date:"2020-11-05T06:30:59Z"},i=void 0,r={},p=[{value:"Sample Repository",id:"sample-repository",level:2},{value:"The Actual Module",id:"the-actual-module",level:2},{value:"Location ./sample/ or ./sample.py",id:"location-sample-or-samplepy",level:3},{value:"Test Suite",id:"test-suite",level:2},{value:"Location ./test_sample.py or ./tests",id:"location-test_samplepy-or-tests",level:3},{value:"setup.py example",id:"setuppy-example",level:2}];function c(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-toc"})}),"\n",(0,o.jsx)(t.h2,{id:"sample-repository",children:"Sample Repository"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",children:"README.rst\nLICENSE\nsetup.py\nrequirements.txt\nsample/__init__.py\nsample/core.py\nsample/helpers.py\ndocs/conf.py\ndocs/index.rst\ntests/test_basic.py\ntests/test_advanced.py\n"})}),"\n",(0,o.jsx)(t.h2,{id:"the-actual-module",children:"The Actual Module"}),"\n",(0,o.jsx)(t.h3,{id:"location-sample-or-samplepy",children:"Location ./sample/ or ./sample.py"}),"\n",(0,o.jsx)(t.p,{children:"Your module package is the core focus of the repository. It should not be tucked away:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",children:"./sample/\n"})}),"\n",(0,o.jsx)(t.p,{children:"If your module consists of only a single file, you can place it directly in the root of your repository:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",children:"./sample.py\n"})}),"\n",(0,o.jsx)(t.p,{children:"Your library does not belong in an ambiguous src or python subdirectory."}),"\n",(0,o.jsx)(t.h2,{id:"test-suite",children:"Test Suite"}),"\n",(0,o.jsx)(t.h3,{id:"location-test_samplepy-or-tests",children:"Location ./test_sample.py or ./tests"}),"\n",(0,o.jsx)(t.p,{children:"Starting out, a small test suite will often exist in a single file:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",children:"./test_sample.py\n"})}),"\n",(0,o.jsx)(t.p,{children:"Once a test suite grows, you can move your tests to a directory, like so:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",children:"tests/test_basic.py\ntests/test_advanced.py\n"})}),"\n",(0,o.jsx)(t.p,{children:"Obviously, these test modules must import your packaged module to test it. You can do this a few ways:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Expect the package to be installed in site-packages."}),"\n",(0,o.jsx)(t.li,{children:"Use a simple (but explicit) path modification to resolve the package properly."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"I highly recommend the latter. Requiring a developer to run setup.py develop to test an actively changing codebase also requires them to have an isolated environment setup for each instance of the codebase."}),"\n",(0,o.jsx)(t.p,{children:"To give the individual tests import context, create a tests/context.py file:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-py",children:"import os\nimport sys\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(**file**), '..')))\n\nimport sample\n"})}),"\n",(0,o.jsx)(t.p,{children:"Then, within the individual test modules, import the module like so:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-py",children:"from .context import sample\n"})}),"\n",(0,o.jsx)(t.p,{children:"This will always work as expected, regardless of installation method."}),"\n",(0,o.jsx)(t.p,{children:"Some people will assert that you should distribute your tests within your module itself \u2013 I disagree. It often increases complexity for your users; many test suites often require additional dependencies and runtime contexts."}),"\n",(0,o.jsx)(t.h2,{id:"setuppy-example",children:"setup.py example"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",children:"# Download the setup.py file:\n#  download with wget\nwget https://raw.githubusercontent.com/navdeep-G/setup.py/master/setup.py -O setup.py\n\n#  download with curl\ncurl -O https://raw.githubusercontent.com/navdeep-G/setup.py/master/setup.py\n"})})]})}function d(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>i});var n=s(6540);const o={},l=n.createContext(o);function a(e){const t=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(l.Provider,{value:t},e.children)}}}]);